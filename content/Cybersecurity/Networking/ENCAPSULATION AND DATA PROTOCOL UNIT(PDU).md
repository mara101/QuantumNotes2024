Encapsulation is a fundamental concept in networking that refers to the process of wrapping data with protocol information at each layer of the [[ISO-OSI MODEL|OSI]] or TCP/IP models. As data moves down the protocol stack on the sender’s side, each layer adds its own header (and sometimes a trailer), creating a new Protocol Data Unit (PDU) that is passed to the layer below it. This process is reversed at the receiving end, where each layer strips off the headers to interpret the data and pass it up to the next layer.
#### The Encapsulation Process
![[Screenshot_20241016_171241.png|300]]
Encapsulation begins when data is generated by an application (for example, a web browser) and needs to be sent over the network. The process proceeds as follows:

1. **Application Layer**: At the top of the OSI model (Layer 7), the application generates data that needs to be transmitted. This data might be a request to load a web page or send an email. It doesn’t have any format defined for transmission across a network yet.
    
2. **Presentation Layer**: The data is translated into a format suitable for network transmission. This could involve data encryption or compression, depending on the application’s needs. However, no PDU is added here—only translation takes place.
    
3. **Session Layer**: The session layer handles the setup, management, and termination of the connection. Again, there is typically no PDU at this level; instead, session-related information like checkpoints or session IDs is managed.
    
4. **Transport Layer**: In Layer 4, the transport layer breaks down the data into smaller units called **segments** (in TCP) or **datagrams** (in UDP). A transport layer header is added to each segment, which includes important control information such as source and destination ports, sequence numbers (for TCP), and error-checking data. This header is essential for ensuring that data is reassembled correctly at the receiver’s end and that missing or corrupted segments can be retransmitted.
    
5. **Network Layer**: The transport layer passes the segment to the network layer (Layer 3), where it is encapsulated inside an **IP packet**. The IP header contains source and destination IP addresses, which are critical for routing the packet through different networks. It also contains additional control information, such as the Time-to-Live (TTL) value, which limits the lifespan of a packet in the network.
    
6. **Data Link Layer**: The network layer sends the packet down to the data link layer (Layer 2), where it is encapsulated within a **frame**. The frame includes a header that holds the MAC addresses (both source and destination) necessary for delivering the packet within the same local network. The data link layer often also adds a trailer that includes a Frame Check Sequence (FCS) to help detect transmission errors.
    
7. **Physical Layer**: At the physical layer (Layer 1), the frame is converted into **bits** (ones and zeros) and transmitted over the physical medium (such as an Ethernet cable or a Wi-Fi signal) to the receiving device.
    

#### Decapsulation

When the encapsulated data reaches its destination, the process of decapsulation begins. As the data travels up the OSI or TCP/IP stack, each layer removes its header (and trailer, if applicable), extracting and interpreting the PDU of the corresponding layer. The receiving device uses the information in each header (such as MAC addresses, IP addresses, and port numbers) to ensure that the data is correctly delivered to the intended application.
